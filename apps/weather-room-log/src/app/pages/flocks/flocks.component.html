<div class="wrap">
  <h1>Flocks</h1>

  <ng-container *ngFor="let perf of performances$ | async">
    <div class="performance">
      <header>
        <h3 class="time">{{ perf.startTime.toJSDate() | date: 'full' }}</h3>
        <app-toggle
          *ngIf="perf.viewers.length > 1"
          (checkedChange)="setStacked(perf.id, $event)"
          >stack</app-toggle
        >
      </header>
      <div class="viewers" [style.height.rem]="getViewersHeight(perf)">
        <ng-container *ngFor="let viewer of perf.viewers; let i = index">
          <div
            class="viewer"
            [class.stacked]="isStacked(perf.id)"
            [style.top.rem]="getTopOffset(perf.id, i)"
          >
            <h4 class="name" [class.stacked]="isStacked(perf.id)">
              {{ viewer.name }}
            </h4>
            <div class="actions">
              <ng-container *ngFor="let action of viewer.actions">
                <div
                  class="action"
                  [class.yellow]="action.trackId === TrackId.REBECCA"
                  [class.cyan]="action.trackId === TrackId.CRISTI"
                  [class.pink]="action.trackId === TrackId.JACOB"
                  [style.width]="action.width && action.width + '%'"
                  [class.stretch]="!action.width"
                ></div>
              </ng-container>
            </div>
          </div>
        </ng-container>
      </div>
    </div>
  </ng-container>
</div>
